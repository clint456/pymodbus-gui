# 快速启动指南

## 运行程序

### Windows
双击 `启动程序.bat` 或在命令行中运行：
```bash
.\启动程序.bat
```

### 命令行（所有平台）
```bash
# 激活虚拟环境（如果使用 Poetry）
poetry shell

# 运行程序
python -m pymodbus_gui.run
```

## 快速开始

### 1. Modbus Poll 客户端使用

#### 添加设备
1. 点击菜单：`Poll设备` -> `添加 Poll 设备`
2. 填写设备信息：
   - 设备 ID：唯一标识（如 device_001）
   - 名称：描述性名称
   - 连接类型：TCP 或 RTU
   - 从站地址：1-247
3. 配置连接参数：
   - **TCP**: IP 地址和端口（默认 502）
   - **RTU**: 串口端口、波特率等
4. 点击"确定"

#### 连接设备
1. 在"Poll 设备管理"选项卡找到设备
2. 点击"连接"按钮
3. 等待连接成功提示

#### 执行操作
1. 切换到"Poll 设备操作"选项卡
2. 选择已连接的设备
3. 选择功能码（如：03-读保持寄存器）
4. 输入起始地址和数量
5. 点击"执行"

### 2. Modbus Slave 服务器使用

#### 创建 Slave
1. 点击菜单：`Slave服务器` -> `添加 Slave 服务器`
2. 填写基本信息：
   - Slave ID：唯一标识（如 slave_001）
   - 名称：描述性名称
   - 连接类型：TCP 或 RTU
   - 从站地址：1-247
3. 配置连接参数：
   - **TCP**: 监听地址（0.0.0.0）和端口（502）
   - **RTU**: 串口端口、波特率等
4. 设置寄存器数量（默认各 1000）
5. 点击"确定"

#### 配置点表（可选）
1. 先创建模板：菜单 -> `Slave服务器` -> `创建点表模板`
2. 在 Excel 中编辑点表：
   ```
   地址 | 点位名称 | 寄存器类型 | 初始值 | 描述 | 单位 | 最小值 | 最大值 | 只读
   0    | 运行状态 | 线圈       | 0      | ...  | ...  | ...    | ...    | 否
   ```
3. 在添加 Slave 对话框中点击"导入点表"
4. 选择编辑好的 Excel 文件

#### 启动 Slave
1. 切换到"Slave 服务器管理"选项卡
2. 从左侧列表选择 Slave
3. 点击"启动服务器"按钮
4. 查看右侧寄存器监控界面

#### 监控和编辑
1. 查看各类寄存器当前值
2. 点击"写入"按钮修改寄存器值（非只读）
3. 启用"自动刷新"实时监控
4. 点击"导出点表"保存配置

### 3. 测试连接

#### 本地测试
1. 创建一个 TCP Slave（端口 502）
2. 创建一个 TCP Poll 设备（连接 127.0.0.1:502）
3. 启动 Slave 服务器
4. 连接 Poll 设备
5. 在 Poll 操作界面读写寄存器

#### 跨机器测试
1. 机器A：运行 Slave 服务器
   - 配置监听地址为 0.0.0.0
   - 确保防火墙允许端口
2. 机器B：运行 Poll 客户端
   - 配置连接到机器A的IP和端口
   - 连接并测试

## Excel 配置示例

### Poll 设备配置
```excel
设备ID    | 设备名称   | 连接类型 | 从站地址 | 串口端口 | 波特率 | ... | IP地址      | TCP端口 | 超时时间
device_01 | 温控器01   | TCP     | 1       |          |        | ... | 192.168.1.100 | 502    | 3
device_02 | 压力传感器 | RTU     | 2       | COM3     | 9600   | ... |             |        | 3
```

### Slave 点表配置
```excel
地址 | 点位名称 | 寄存器类型   | 初始值 | 描述       | 单位   | 最小值 | 最大值 | 只读
0    | 运行状态 | 线圈         | 0      | 设备运行   |        |        |        | 否
0    | 温度设定 | 保持寄存器   | 250    | 温度设定值 | 0.1°C  | 0      | 1000   | 否
1    | 当前温度 | 输入寄存器   | 235    | 实际温度   | 0.1°C  | 0      | 1000   | 是
```

## 常见问题

### Q: 连接失败怎么办？
A: 检查：
- 设备是否在线
- IP地址和端口是否正确
- 防火墙是否允许
- 串口是否被其他程序占用

### Q: Slave 启动失败？
A: 检查：
- 端口是否被占用
- 串口是否存在
- 是否有管理员权限（某些串口需要）

### Q: 读写操作失败？
A: 检查：
- 设备地址是否正确
- 从站地址是否匹配
- 寄存器地址是否有效
- 功能码是否支持

### Q: 如何批量导入设备？
A: 
1. 创建配置模板（文件 -> 创建配置模板）
2. 在 Excel 中填写设备信息
3. 导入配置（文件 -> 导入设备配置）

### Q: 点表地址冲突怎么办？
A: 
- 同一寄存器类型中地址不能重复
- 不同寄存器类型可以使用相同地址
- 检查 Excel 中是否有重复地址

## 技术支持

- 查看日志：切换到"操作日志"选项卡
- 导出日志：在日志界面点击"导出日志"
- 查看详细说明：菜单 -> `帮助` -> `使用说明`

## 键盘快捷键

- `Ctrl+N`: 添加 Poll 设备
- `Ctrl+Shift+N`: 添加 Slave 服务器
- `Ctrl+I`: 导入设备配置
- `Ctrl+E`: 导出设备配置
- `Ctrl+Q`: 退出程序
